var a,b,c;!function(d){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m=b&&b.split("/"),n=s.map,o=n&&n["*"]||{};if(a&&"."===a.charAt(0))if(b){for(m=m.slice(0,m.length-1),a=m.concat(a.split("/")),j=0;j<a.length;j+=1)if(l=a[j],"."===l)a.splice(j,1),j-=1;else if(".."===l){if(1===j&&(".."===a[2]||".."===a[0]))break;j>0&&(a.splice(j-1,2),j-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((m||o)&&n){for(c=a.split("/"),j=c.length;j>0;j-=1){if(d=c.slice(0,j).join("/"),m)for(k=m.length;k>0;k-=1)if(e=n[m.slice(0,k).join("/")],e&&(e=e[d])){f=e,g=j;break}if(f)break;!h&&o&&o[d]&&(h=o[d],i=j)}!f&&h&&(f=h,g=i),f&&(c.splice(0,g,f),a=c.join("/"))}return a}function g(a,b){return function(){return n.apply(d,v.call(arguments,0).concat([a,b]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(a){if(e(r,a)){var b=r[a];delete r[a],t[a]=!0,m.apply(d,b)}if(!e(q,a)&&!e(t,a))throw new Error("No "+a);return q[a]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(a,b,c,f){var h,k,l,m,n,s,u=[],v=typeof c;if(f=f||a,"undefined"===v||"function"===v){for(b=!b.length&&c.length?["require","exports","module"]:b,n=0;n<b.length;n+=1)if(m=o(b[n],f),k=m.f,"require"===k)u[n]=p.require(a);else if("exports"===k)u[n]=p.exports(a),s=!0;else if("module"===k)h=u[n]=p.module(a);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(a+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=c?c.apply(q[a],u):void 0,a&&(h&&h.exports!==d&&h.exports!==q[a]?q[a]=h.exports:l===d&&s||(q[a]=l))}else a&&(q[a]=c)},a=b=n=function(a,b,c,e,f){return"string"==typeof a?p[a]?p[a](b):j(o(a,b).f):(a.splice||(s=a,b.splice?(a=b,b=c,c=null):a=d),b=b||function(){},"function"==typeof c&&(c=e,e=f),e?m(d,a,b,c):setTimeout(function(){m(d,a,b,c)},4),n)},n.config=function(a){return s=a,s.deps&&n(s.deps,s.callback),n},a._defined=q,c=function(a,b,c){b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},c.amd={jQuery:!0}}(),function(){b.config({paths:{annie:"../node_modules/annie/annie",GMaps:"../node_modules/gmaps/gmaps",microbox:"../node_modules/microbox/microbox",strftime:"../node_modules/strftime/strftime",umodel:"../node_modules/umodel/umodel",uxhr:"../node_modules/uxhr/uxhr",u:"../node_modules/u/u"},shim:{strftime:{exports:"strftime"}}}),c("config",function(){}),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof c&&c.amd?c("annie",[],b):a.annie=b()}(this,function(){function a(a,b){return function(){a.apply(b,[].slice.call(arguments))}}function b(a,b){return(a.currentStyle||getComputedStyle(a))[b]}var c=document,d=navigator,e=window,f={};return f.ie=d.appVersion.search("MSIE")>-1?parseInt(d.appVersion.slice(22,26),10):!1,f.performance=!(!e.performance||!e.performance.now),f.vendor=function(){if(f.ie&&f.ie<9)return"ms";var a,b,d,e=" O ms Moz Webkit".split(" "),g=c.body.style;for(a=e.length;a--;)if(b=e[a],d=""!==b?b+"Transform":"transform",void 0!==g[d])return b}(),f.requestAnimationFrame=a(e.requestAnimationFrame||e[f.vendor+"RequestAnimationFrame"]||function(){var a=0;return function(b){var c=+new Date,d=Math.max(0,16-(c-a)),e=setTimeout(function(){b(c+d)},d);return a=c+d,e}}(),e),f.cancelAnimationFrame=a(e.cancelAnimationFrame||e.cancelRequestAnimationFrame||e[f.vendor+"CancelAnimationFrame"]||e[f.vendor+"CancelRequestAnimationFrame"]||clearTimeout,e),f.transform=function(){var a=f.vendor+"Transform";return void 0!==c.body.style[a]?a:void 0}(),f["3d"]=function(){var a=f.transform;if(!a)return!1;var d=c.body,e=c.createElement("p");e.style[a]="translate3d(1px,1px,1px)",d.appendChild(e);var g=b(e,a);return d.removeChild(e),void 0!==g&&"none"!==g&&g.length>0}(),f}),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof c&&c.amd?c("u",[],b):a.u=b()}(this,function(){var a,b={}.hasOwnProperty,c=[].slice;return a={each:function(a,c){var d,e,f,g;if("undefined"!=typeof a.length)for(d=f=0,g=a.length;g>f;d=++f)e=a[d],c(e,d);else for(d in a)b.call(a,d)&&(e=a[d],c(e,d));return void 0},extend:function(){var a,b,d,e,f,g;if(b=arguments[0],e=2<=arguments.length?c.call(arguments,1):[],b&&e)for(f=0,g=e.length;g>f;f++){d=e[f];for(a in d)b[a]=d[a]}return b},fluent:function(a){return function(){return a.apply(this,arguments),this}},one:function(a){var b;for(b in a)return b},keys:function(a){var c,d;d=[];for(c in a)b.call(a,c)&&d.push(c);return d},classList:{add:function(b,c){return a.classList.contains(b,c)?void 0:null!=b.className.baseVal?b.setAttribute("class",""+b.className.baseVal+" className"):b.className+=" "+c},remove:function(a,b){var c;return c=new RegExp("(^|\\s)"+b+"(?:\\s|$)"),null!=a.className.baseVal?a.setAttribute("class",(a.className.baseVal+"").replace(c,"$1")):a.className=(a.className+"").replace(c,"$1")},toggle:function(b,c){var d;return d=a.classList.contains(b,c)?"remove":"add",a.classList[d](b,c)},contains:function(a,b){var c;return c=null!=a.className.baseVal?a.className.baseVal:a.className,c.indexOf(b)>-1}}}});var a=function(a,b){return function(){return a.apply(b,arguments)}};c("throbber",["require","u"],function(b){var c,d;return d=b("u"),c=function(){function b(b,c){this.bubble=b,this.graph=c,this.clear=a(this.clear,this),this.throb=a(this.throb,this),this.state=!0,this.r=this.bubble.attr("r"),this.x=this.bubble.attr("cx"),this.y=this.bubble.attr("cy"),this.throb(),this.showMessage()}return b.prototype.options={duration:500,easing:"linear",size:10,text:"click me!"},b.prototype.throb=function(){return this.state=!this.state,this.bubble.animate({r:this.r+(this.state?this.options.size:0)},this.options.duration,this.options.easing,this.throb)},b.prototype.clear=function(){var a=this;return this.bubble.stop(),d.classList.add(this.text,"fade-out"),setTimeout(function(){return document.body.removeChild(a.text)},2e3)},b.prototype.showMessage=function(){var a;return a=this.text=document.createElement("div"),a.id="clickme",a.innerHTML=this.options.text,a.style.cssText="left:"+(this.x-this.r)+"px; top:"+this.y+"px",document.body.appendChild(a),a.style.marginLeft=""+(this.r-a.offsetWidth/2)+"px",d.classList.add(a,"fade-in"),this.attachMessageEvents()},b.prototype.attachMessageEvents=function(){var a=this;return this.text.addEventListener("mouseover",function(){return a.graph.over(a.bubble)}),this.text.addEventListener("mouseout",function(){return a.graph.out(a.bubble)}),this.text.addEventListener("click",function(){return a.graph.click(a.bubble)})},b}()}),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof c&&c.amd?c("umodel",[],b):a.umodel=b()}(this,function(){var a,b,c={}.hasOwnProperty;return b={extend:function(a,b){var d;for(d in b)c.call(b,d)&&(a[d]=b[d]);return a},trim:function(){var a,b;return"".trim?function(a){return a.trim()}:(a=/^\s\s*/,b=/\s\s*$/,function(c){return c.replace(a,"").replace(b,"")})}()},a=function(){function a(a,c){this._data=null!=a?a:{},this.options={separator:"/"},c&&b.extend(this.options,c),this.events={}}return a.prototype.get=function(a){return this.trigger("get",a),this._get(this._split(a),this._data)},a.prototype.set=function(a,b){var c;return c=this._get(this._split(a),this._data),this._set(this._split(a),b,!1,this._data),this.trigger("set",a,b,c)},a.prototype.setnx=function(a,b){var c;return c=this._get(this._split(a),this._data),this._set(this._split(a),b,!0,this._data),this.trigger("setnx",a,b,c)},a.prototype.on=function(a,b){var c,d;if(b)return this._on(a,b);d=[];for(c in a)b=a[c],d.push(this._on(c,b));return d},a.prototype.trigger=function(a,b,c,d){var e,f,g,h,i;if(null==b&&(b="*"),b=this._normalize(b),a in this.events){h=this.events[a],i=[];for(e in h)g=h[e],"*"===e||0===(b+"/").indexOf(e+"/")?i.push(function(){var a,e,h;for(h=[],a=0,e=g.length;e>a;a++)f=g[a],null!=d?h.push(f.call(this,b,c,d)):h.push(f.call(this,b,c));return h}.call(this)):i.push(void 0);return i}},a.prototype._get=function(a,b,c){var d;return null==c&&(c=[]),d=a.shift(),d?d in b?(c.push(d),this._get(a,b[d],c)):void 0:b},a.prototype._set=function(a,b,c,d,e){var f;return null==c&&(c=!1),null==e&&(e=[]),f=a.shift(),a.length?(f in d||(d[f]={}),e.push(f),this._set(a,b,c,d[f],e)):c&&f in d?void 0:d[f]=b},a.prototype._on=function(a,c){var d,e,f,g,h,i,j;for(f=a.split(":"),e=f[0].split(" "),g=this._normalize(f[1]||"*"),j=[],h=0,i=e.length;i>h;h++)d=e[h],d=b.trim(d),d in this.events||(this.events[d]={}),g in this.events[d]||(this.events[d][g]=[]),j.push(this.events[d][g].push(c));return j},a.prototype._normalize=function(a){var c;return c=this.options.separator,a=b.trim(a),a.charAt(0)===c&&(a=a.slice(1)),a.charAt(a.length-1)===c&&(a=a.slice(0,-1)),a},a.prototype._split=function(a){return this._normalize(a).split(this.options.separator)},a}()}),c("util",["require"],function(){var a;return a={strtotime:function(a){return new Date(""+a+"-01T12:00:00")},log:function(a){var b;return b=+new Date,this.time||(this.time=b),console.log(a," ("+(b-this.time)+"ms)"),this.time=b}}});var a=function(a,b){return function(){return a.apply(b,arguments)}};c("bubblegraph",["require","throbber","umodel","util","u"],function(b){var c,d,e,f,g;return d=b("throbber"),f=b("umodel"),g=b("util"),e=b("u"),c=function(){function b(b){this.out=a(this.out,this),this.over=a(this.over,this),this.click=a(this.click,this),_.extend(this.options,b),this.render()}return b.prototype.options={colors:[],data:{},element:document.body},b.prototype.model=new f({bubbles:{},throbber:null}),b.prototype.animations={active:Raphael.animation({opacity:1,"stroke-width":5},200),inactive:Raphael.animation({opacity:.5,"stroke-width":0},200),over:Raphael.animation({opacity:.7},200),out:Raphael.animation({opacity:.5},200)},b.prototype.render=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p,q=this;for(a=this.options.data,l=this.options.element.getBoundingClientRect(),e=l.height/3,j=Raphael(this.options.element,l.width,l.height),o=0,p=a.length;p>o;o++)f=a[o],n=f.when,null!=n&&(n[0]=g.strtotime(n[0]),n[1]=g.strtotime(n[1]),c=Math.abs(n[1].getTime()-n[0].getTime()),b=Math.ceil(c/864e5),f.timespan=b);return m=_.pluck(a,"timespan"),i=_.max(m),h=a.length-1,k={r:null,x:null,y:null},_.each(a,function(a,b){var c,f,g,m,n;return f="color"+b%5,g=l.width*a.timespan/(2*i*Math.PI),g+=i/(5*g),k.x?(n=(l.height-e)/2-.3*g+_.random(0,100),m=k.x+Math.sqrt(Math.abs((n-k.y)*(n-k.y)-(g+k.r)*(g+k.r)))):(m=20+g,n=l.height-g-20),c=j.circle(0,0,g),c.mouseover(function(){return q.over(c)}),c.mouseout(function(){return q.out(c)}),c.click(function(){return q.click(c)}),c.node.setAttribute("class",f),c.node.setAttribute("data-id",b),c.attr({opacity:.5,stroke:"#fff","stroke-width":0}),c.animate({cx:m,cy:n},2e3,"elastic",function(){return b===h?q.model.set("throbber",new d(c,{click:q.click,over:q.over,out:q.out})):void 0}),q.model.set("bubbles/"+b,{active:!1,raphael:c}),k={circle:c,r:g,x:m,y:n}})},b.prototype.deactivate=function(){var a,b,c,d=this;return c=document.querySelector(".detail.active"),a=_.where(this.model.get("bubbles"),{active:!0}),a[0]&&(b=a[0].raphael,setTimeout(function(){return e.classList.remove(b.node,a),b.animate(d.animations.inactive).transform("s1")},10),a[0].active=!1),c?(e.classList.remove(c,"active"),setTimeout(function(){return e.classList.add(c,"hide")},.2),e.classList.add(document.querySelector("#details"),"hide"),document.querySelector("svg").setAttribute("class","")):void 0},b.prototype.activate=function(a){var b,c;return b=a.node.getAttribute("data-id"),e.classList.add(a.node,"active"),e.classList.remove(document.querySelector("#details"),"hide"),c=document.querySelectorAll(".detail")[b],e.classList.remove(c,"hide"),e.classList.add(c,"active"),a.toFront().animate(this.animations.active).transform("s1.1"),document.querySelector("svg").setAttribute("class","small"),this.model.set("bubbles/"+b+"/active",!0)},b.prototype.toggle=function(a){var b;return b=_.where(this.model.get("bubbles"),{active:!0}),this.deactivate(),b[0]&&b[0].raphael===a?void 0:this.activate(a)},b.prototype.click=function(a){var b;return(b=this.model.get("throbber"))&&(b.clear(),this.model.set("throbber",null)),this.toggle(a)},b.prototype.over=function(a){var b;return b=_.where(this.model.get("bubbles"),{active:!0}),b[0]&&a===b[0]?void 0:a.animate(this.animations.over)},b.prototype.out=function(a){var b;return b=_.where(this.model.get("bubbles"),{active:!0}),b[0]&&a===b[0]?void 0:a.animate(this.animations.out)},b}()}),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof c&&c.amd&&c("GMaps",[],b),a.GMaps=b()}(this,function(){if("object"!=typeof window.google||!window.google.maps)throw"Google Maps API is required. Please register the following JavaScript library http://maps.google.com/maps/api/js?sensor=true.";var a=function(a,b){var c;if(a===b)return a;for(c in b)a[c]=b[c];return a},b=function(a,b){var c,d=Array.prototype.slice.call(arguments,2),e=[],f=a.length;if(Array.prototype.map&&a.map===Array.prototype.map)e=Array.prototype.map.call(a,function(a){return callback_params=d,callback_params.splice(0,0,a),b.apply(this,callback_params)});else for(c=0;f>c;c++)callback_params=d,callback_params.splice(0,0,a[c]),e.push(b.apply(this,callback_params));return e},c=function(a){var b,c=[];for(b=0;b<a.length;b++)c=c.concat(a[b]);return c},d=function(a,b){var c=a[0],d=a[1];return b&&(c=a[1],d=a[0]),new google.maps.LatLng(c,d)},f=function(a,b){var c;for(c=0;c<a.length;c++)a[c]=a[c].length>0&&"object"==typeof a[c][0]?f(a[c],b):d(a[c],b);return a},g=function(a,b){var c,a=a.replace("#","");return c="jQuery"in this&&b?$("#"+a,b)[0]:document.getElementById(a)},h=function(a){var b=0,c=0;if(a.offsetParent)do b+=a.offsetLeft,c+=a.offsetTop;while(a=a.offsetParent);return[b,c]},i=function(){var b=document,c=function(d){if(!this)return new c(d);d.zoom=d.zoom||15,d.mapType=d.mapType||"roadmap";var e,f=this,i=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"],j=["mousemove","mouseout","mouseover"],k=["el","lat","lng","mapType","width","height","markerClusterer","enableNewStyle"],l=d.el||d.div,m=d.markerClusterer,n=google.maps.MapTypeId[d.mapType.toUpperCase()],o=new google.maps.LatLng(d.lat,d.lng),p=d.zoomControl||!0,q=d.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"},r=q.style||"DEFAULT",s=q.position||"TOP_LEFT",t=d.panControl||!0,u=d.mapTypeControl||!0,v=d.scaleControl||!0,w=d.streetViewControl||!0,x=x||!0,y={},z={zoom:this.zoom,center:o,mapTypeId:n},A={panControl:t,zoomControl:p,zoomControlOptions:{style:google.maps.ZoomControlStyle[r],position:google.maps.ControlPosition[s]},mapTypeControl:u,scaleControl:v,streetViewControl:w,overviewMapControl:x};if(this.el="string"==typeof d.el||"string"==typeof d.div?g(l,d.context):l,"undefined"==typeof this.el||null===this.el)throw"No element defined.";for(window.context_menu=window.context_menu||{},window.context_menu[f.el.id]={},this.controls=[],this.overlays=[],this.layers=[],this.singleLayers={},this.markers=[],this.polylines=[],this.routes=[],this.polygons=[],this.infoWindow=null,this.overlay_el=null,this.zoom=d.zoom,this.registered_events={},this.el.style.width=d.width||this.el.scrollWidth||this.el.offsetWidth,this.el.style.height=d.height||this.el.scrollHeight||this.el.offsetHeight,google.maps.visualRefresh=d.enableNewStyle,e=0;e<k.length;e++)delete d[k[e]];for(1!=d.disableDefaultUI&&(z=a(z,A)),y=a(z,d),e=0;e<i.length;e++)delete y[i[e]];for(e=0;e<j.length;e++)delete y[j[e]];this.map=new google.maps.Map(this.el,y),m&&(this.markerClusterer=m.apply(this,[this.map]));var B=function(a,b){var c="",d=window.context_menu[f.el.id][a];for(var e in d)if(d.hasOwnProperty(e)){var i=d[e];c+='<li><a id="'+a+"_"+e+'" href="#">'+i.title+"</a></li>"}if(g("gmaps_context_menu")){var j=g("gmaps_context_menu");j.innerHTML=c;var k=j.getElementsByTagName("a"),l=k.length;for(e=0;l>e;e++){var m=k[e],n=function(c){c.preventDefault(),d[this.id.replace(a+"_","")].action.apply(f,[b]),f.hideContextMenu()};google.maps.event.clearListeners(m,"click"),google.maps.event.addDomListenerOnce(m,"click",n,!1)}var o=h.apply(this,[f.el]),p=o[0]+b.pixel.x-15,q=o[1]+b.pixel.y-15;j.style.left=p+"px",j.style.top=q+"px",j.style.display="block"}};this.buildContextMenu=function(a,b){if("marker"===a){b.pixel={};var c=new google.maps.OverlayView;c.setMap(f.map),c.draw=function(){var d=c.getProjection(),e=b.marker.getPosition();b.pixel=d.fromLatLngToContainerPixel(e),B(a,b)}}else B(a,b)},this.setContextMenu=function(a){window.context_menu[f.el.id][a.control]={};var c,d=b.createElement("ul");for(c in a.options)if(a.options.hasOwnProperty(c)){var e=a.options[c];window.context_menu[f.el.id][a.control][e.name]={title:e.title,action:e.action}}d.id="gmaps_context_menu",d.style.display="none",d.style.position="absolute",d.style.minWidth="100px",d.style.background="white",d.style.listStyle="none",d.style.padding="8px",d.style.boxShadow="2px 2px 6px #ccc",b.body.appendChild(d);var h=g("gmaps_context_menu");google.maps.event.addDomListener(h,"mouseout",function(a){a.relatedTarget&&this.contains(a.relatedTarget)||window.setTimeout(function(){h.style.display="none"},400)},!1)},this.hideContextMenu=function(){var a=g("gmaps_context_menu");a&&(a.style.display="none")};for(var C=function(a,b){google.maps.event.addListener(a,b,function(a){void 0==a&&(a=this),d[b].apply(this,[a]),f.hideContextMenu()})},D=0;D<i.length;D++){var E=i[D];E in d&&C(this.map,E)}for(var D=0;D<j.length;D++){var E=j[D];E in d&&C(this.map,E)}google.maps.event.addListener(this.map,"rightclick",function(a){d.rightclick&&d.rightclick.apply(this,[a]),void 0!=window.context_menu[f.el.id].map&&f.buildContextMenu("map",a)}),this.refresh=function(){google.maps.event.trigger(this.map,"resize")},this.fitZoom=function(){var a,b=[],c=this.markers.length;for(a=0;c>a;a++)b.push(this.markers[a].getPosition());this.fitLatLngBounds(b)},this.fitLatLngBounds=function(a){for(var b=a.length,c=new google.maps.LatLngBounds,d=0;b>d;d++)c.extend(a[d]);this.map.fitBounds(c)},this.setCenter=function(a,b,c){this.map.panTo(new google.maps.LatLng(a,b)),c&&c()},this.getElement=function(){return this.el},this.zoomIn=function(a){a=a||1,this.zoom=this.map.getZoom()+a,this.map.setZoom(this.zoom)},this.zoomOut=function(a){a=a||1,this.zoom=this.map.getZoom()-a,this.map.setZoom(this.zoom)};var F,G=[];for(F in this.map)"function"!=typeof this.map[F]||this[F]||G.push(F);for(e=0;e<G.length;e++)!function(a,b,c){a[c]=function(){return b[c].apply(b,arguments)}}(this,this.map,G[e])};return c}(this);i.prototype.createControl=function(a){var b=document.createElement("div");b.style.cursor="pointer",b.style.fontFamily="Arial, sans-serif",b.style.fontSize="13px",b.style.boxShadow="rgba(0, 0, 0, 0.398438) 0px 2px 4px";for(var c in a.style)b.style[c]=a.style[c];a.id&&(b.id=a.id),a.classes&&(b.className=a.classes),a.content&&(b.innerHTML=a.content);for(var d in a.events)!function(b,c){google.maps.event.addDomListener(b,c,function(){a.events[c].apply(this,[this])})}(b,d);return b.index=1,b},i.prototype.addControl=function(a){var b=google.maps.ControlPosition[a.position.toUpperCase()];delete a.position;var c=this.createControl(a);return this.controls.push(c),this.map.controls[b].push(c),c},i.prototype.createMarker=function(b){if(void 0==b.lat&&void 0==b.lng&&void 0==b.position)throw"No latitude or longitude defined.";var c=this,d=b.details,e=b.fences,f=b.outside,g={position:new google.maps.LatLng(b.lat,b.lng),map:null};delete b.lat,delete b.lng,delete b.fences,delete b.outside;var h=a(g,b),i=new google.maps.Marker(h);if(i.fences=e,b.infoWindow){i.infoWindow=new google.maps.InfoWindow(b.infoWindow);for(var j=["closeclick","content_changed","domready","position_changed","zindex_changed"],k=0;k<j.length;k++)!function(a,c){b.infoWindow[c]&&google.maps.event.addListener(a,c,function(a){b.infoWindow[c].apply(this,[a])})}(i.infoWindow,j[k])}for(var l=["animation_changed","clickable_changed","cursor_changed","draggable_changed","flat_changed","icon_changed","position_changed","shadow_changed","shape_changed","title_changed","visible_changed","zindex_changed"],m=["dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"],k=0;k<l.length;k++)!function(a,c){b[c]&&google.maps.event.addListener(a,c,function(){b[c].apply(this,[this])})}(i,l[k]);for(var k=0;k<m.length;k++)!function(a,c,d){b[d]&&google.maps.event.addListener(c,d,function(c){c.pixel||(c.pixel=a.getProjection().fromLatLngToPoint(c.latLng)),b[d].apply(this,[c])})}(this.map,i,m[k]);return google.maps.event.addListener(i,"click",function(){this.details=d,b.click&&b.click.apply(this,[this]),i.infoWindow&&(c.hideInfoWindows(),i.infoWindow.open(c.map,i))}),google.maps.event.addListener(i,"rightclick",function(a){a.marker=this,b.rightclick&&b.rightclick.apply(this,[a]),void 0!=window.context_menu[c.el.id].marker&&c.buildContextMenu("marker",a)}),i.fences&&google.maps.event.addListener(i,"dragend",function(){c.checkMarkerGeofence(i,function(a,b){f(a,b)})}),i},i.prototype.addMarker=function(a){var b;if(a.hasOwnProperty("gm_accessors_"))b=a;else{if(!(a.hasOwnProperty("lat")&&a.hasOwnProperty("lng")||a.position))throw"No latitude or longitude defined.";b=this.createMarker(a)}return b.setMap(this.map),this.markerClusterer&&this.markerClusterer.addMarker(b),this.markers.push(b),i.fire("marker_added",b,this),b},i.prototype.addMarkers=function(a){for(var b,c=0;b=a[c];c++)this.addMarker(b);return this.markers},i.prototype.hideInfoWindows=function(){for(var a,b=0;a=this.markers[b];b++)a.infoWindow&&a.infoWindow.close()},i.prototype.removeMarker=function(a){for(var b=0;b<this.markers.length;b++)if(this.markers[b]===a){this.markers[b].setMap(null),this.markers.splice(b,1),this.markerClusterer&&this.markerClusterer.removeMarker(a),i.fire("marker_removed",a,this);break}return a},i.prototype.removeMarkers=function(a){for(var a=a||this.markers,b=0;b<this.markers.length;b++)this.markers[b]===a[b]&&this.markers[b].setMap(null);for(var c=[],b=0;b<this.markers.length;b++)null!=this.markers[b].getMap()&&c.push(this.markers[b]);this.markers=c},i.prototype.drawOverlay=function(a){var b=new google.maps.OverlayView,c=!0;return b.setMap(this.map),null!=a.auto_show&&(c=a.auto_show),b.onAdd=function(){var c=document.createElement("div");c.style.borderStyle="none",c.style.borderWidth="0px",c.style.position="absolute",c.style.zIndex=100,c.innerHTML=a.content,b.el=c,a.layer||(a.layer="overlayLayer");var d=this.getPanes(),e=d[a.layer],f=["contextmenu","DOMMouseScroll","dblclick","mousedown"];e.appendChild(c);for(var g=0;g<f.length;g++)!function(a,b){google.maps.event.addDomListener(a,b,function(a){-1!=navigator.userAgent.toLowerCase().indexOf("msie")&&document.all?(a.cancelBubble=!0,a.returnValue=!1):a.stopPropagation()})}(c,f[g]);google.maps.event.trigger(this,"ready")},b.draw=function(){var d=this.getProjection(),e=d.fromLatLngToDivPixel(new google.maps.LatLng(a.lat,a.lng));a.horizontalOffset=a.horizontalOffset||0,a.verticalOffset=a.verticalOffset||0;var f=b.el,g=f.children[0],h=g.clientHeight,i=g.clientWidth;switch(a.verticalAlign){case"top":f.style.top=e.y-h+a.verticalOffset+"px";break;default:case"middle":f.style.top=e.y-h/2+a.verticalOffset+"px";break;case"bottom":f.style.top=e.y+a.verticalOffset+"px"}switch(a.horizontalAlign){case"left":f.style.left=e.x-i+a.horizontalOffset+"px";break;default:case"center":f.style.left=e.x-i/2+a.horizontalOffset+"px";break;case"right":f.style.left=e.x+a.horizontalOffset+"px"}f.style.display=c?"block":"none",c||a.show.apply(this,[f])},b.onRemove=function(){var c=b.el;a.remove?a.remove.apply(this,[c]):(b.el.parentNode.removeChild(b.el),b.el=null)},this.overlays.push(b),b},i.prototype.removeOverlay=function(a){for(var b=0;b<this.overlays.length;b++)if(this.overlays[b]===a){this.overlays[b].setMap(null),this.overlays.splice(b,1);break}},i.prototype.removeOverlays=function(){for(var a,b=0;a=this.overlays[b];b++)a.setMap(null);this.overlays=[]},i.prototype.drawPolyline=function(a){var b=[],c=a.path;if(c.length)if(void 0===c[0][0])b=c;else for(var d,e=0;d=c[e];e++)b.push(new google.maps.LatLng(d[0],d[1]));var f={map:this.map,path:b,strokeColor:a.strokeColor,strokeOpacity:a.strokeOpacity,strokeWeight:a.strokeWeight,geodesic:a.geodesic,clickable:!0,editable:!1,visible:!0};a.hasOwnProperty("clickable")&&(f.clickable=a.clickable),a.hasOwnProperty("editable")&&(f.editable=a.editable),a.hasOwnProperty("icons")&&(f.icons=a.icons),a.hasOwnProperty("zIndex")&&(f.zIndex=a.zIndex);for(var g=new google.maps.Polyline(f),h=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],j=0;j<h.length;j++)!function(b,c){a[c]&&google.maps.event.addListener(b,c,function(b){a[c].apply(this,[b])})}(g,h[j]);return this.polylines.push(g),i.fire("polyline_added",g,this),g},i.prototype.removePolyline=function(a){for(var b=0;b<this.polylines.length;b++)if(this.polylines[b]===a){this.polylines[b].setMap(null),this.polylines.splice(b,1),i.fire("polyline_removed",a,this);break}},i.prototype.removePolylines=function(){for(var a,b=0;a=this.polylines[b];b++)a.setMap(null);this.polylines=[]},i.prototype.drawCircle=function(b){b=a({map:this.map,center:new google.maps.LatLng(b.lat,b.lng)},b),delete b.lat,delete b.lng;for(var c=new google.maps.Circle(b),d=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],e=0;e<d.length;e++)!function(a,c){b[c]&&google.maps.event.addListener(a,c,function(a){b[c].apply(this,[a])})}(c,d[e]);return this.polygons.push(c),c},i.prototype.drawRectangle=function(b){b=a({map:this.map},b);var c=new google.maps.LatLngBounds(new google.maps.LatLng(b.bounds[0][0],b.bounds[0][1]),new google.maps.LatLng(b.bounds[1][0],b.bounds[1][1]));b.bounds=c;for(var d=new google.maps.Rectangle(b),e=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],f=0;f<e.length;f++)!function(a,c){b[c]&&google.maps.event.addListener(a,c,function(a){b[c].apply(this,[a])})}(d,e[f]);return this.polygons.push(d),d},i.prototype.drawPolygon=function(d){var e=!1;d.hasOwnProperty("useGeoJSON")&&(e=d.useGeoJSON),delete d.useGeoJSON,d=a({map:this.map},d),0==e&&(d.paths=[d.paths.slice(0)]),d.paths.length>0&&d.paths[0].length>0&&(d.paths=c(b(d.paths,f,e)));for(var g=new google.maps.Polygon(d),h=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],j=0;j<h.length;j++)!function(a,b){d[b]&&google.maps.event.addListener(a,b,function(a){d[b].apply(this,[a])})}(g,h[j]);return this.polygons.push(g),i.fire("polygon_added",g,this),g},i.prototype.removePolygon=function(a){for(var b=0;b<this.polygons.length;b++)if(this.polygons[b]===a){this.polygons[b].setMap(null),this.polygons.splice(b,1),i.fire("polygon_removed",a,this);break}},i.prototype.removePolygons=function(){for(var a,b=0;a=this.polygons[b];b++)a.setMap(null);this.polygons=[]},i.prototype.getFromFusionTables=function(a){var b=a.events;delete a.events;var c=a,d=new google.maps.FusionTablesLayer(c);for(var e in b)!function(a,c){google.maps.event.addListener(a,c,function(a){b[c].apply(this,[a])})}(d,e);return this.layers.push(d),d},i.prototype.loadFromFusionTables=function(a){var b=this.getFromFusionTables(a);return b.setMap(this.map),b},i.prototype.getFromKML=function(a){var b=a.url,c=a.events;delete a.url,delete a.events;var d=a,e=new google.maps.KmlLayer(b,d);for(var f in c)!function(a,b){google.maps.event.addListener(a,b,function(a){c[b].apply(this,[a])})}(e,f);return this.layers.push(e),e},i.prototype.loadFromKML=function(a){var b=this.getFromKML(a);return b.setMap(this.map),b},i.prototype.addLayer=function(a,b){b=b||{};var c;switch(a){case"weather":this.singleLayers.weather=c=new google.maps.weather.WeatherLayer;break;case"clouds":this.singleLayers.clouds=c=new google.maps.weather.CloudLayer;break;case"traffic":this.singleLayers.traffic=c=new google.maps.TrafficLayer;break;case"transit":this.singleLayers.transit=c=new google.maps.TransitLayer;break;case"bicycling":this.singleLayers.bicycling=c=new google.maps.BicyclingLayer;break;case"panoramio":this.singleLayers.panoramio=c=new google.maps.panoramio.PanoramioLayer,c.setTag(b.filter),delete b.filter,b.click&&google.maps.event.addListener(c,"click",function(a){b.click(a),delete b.click});break;case"places":if(this.singleLayers.places=c=new google.maps.places.PlacesService(this.map),b.search||b.nearbySearch){var d={bounds:b.bounds||null,keyword:b.keyword||null,location:b.location||null,name:b.name||null,radius:b.radius||null,rankBy:b.rankBy||null,types:b.types||null};b.search&&c.search(d,b.search),b.nearbySearch&&c.nearbySearch(d,b.nearbySearch)}if(b.textSearch){var e={bounds:b.bounds||null,location:b.location||null,query:b.query||null,radius:b.radius||null};c.textSearch(e,b.textSearch)}}return void 0!==c?("function"==typeof c.setOptions&&c.setOptions(b),"function"==typeof c.setMap&&c.setMap(this.map),c):void 0},i.prototype.removeLayer=function(a){if("string"==typeof a&&void 0!==this.singleLayers[a])this.singleLayers[a].setMap(null),delete this.singleLayers[a];else for(var b=0;b<this.layers.length;b++)if(this.layers[b]===a){this.layers[b].setMap(null),this.layers.splice(b,1);break}};var j,k;return i.prototype.getRoutes=function(b){switch(b.travelMode){case"bicycling":j=google.maps.TravelMode.BICYCLING;break;case"transit":j=google.maps.TravelMode.TRANSIT;break;case"driving":j=google.maps.TravelMode.DRIVING;break;default:j=google.maps.TravelMode.WALKING}k="imperial"===b.unitSystem?google.maps.UnitSystem.IMPERIAL:google.maps.UnitSystem.METRIC;var c={avoidHighways:!1,avoidTolls:!1,optimizeWaypoints:!1,waypoints:[]},d=a(c,b);d.origin=/string/.test(typeof b.origin)?b.origin:new google.maps.LatLng(b.origin[0],b.origin[1]),d.destination=/string/.test(typeof b.destination)?b.destination:new google.maps.LatLng(b.destination[0],b.destination[1]),d.travelMode=j,d.unitSystem=k,delete d.callback;var e=this,f=new google.maps.DirectionsService;f.route(d,function(a,c){if(c===google.maps.DirectionsStatus.OK){for(var d in a.routes)a.routes.hasOwnProperty(d)&&e.routes.push(a.routes[d]);b.callback&&b.callback(e.routes)}else b.error&&b.error(a,c)})},i.prototype.removeRoutes=function(){this.routes=[]},i.prototype.getElevations=function(d){d=a({locations:[],path:!1,samples:256},d),d.locations.length>0&&d.locations[0].length>0&&(d.locations=c(b([d.locations],f,!1)));var e=d.callback;delete d.callback;var g=new google.maps.ElevationService;if(d.path){var h={path:d.locations,samples:d.samples};g.getElevationAlongPath(h,function(a,b){e&&"function"==typeof e&&e(a,b)})}else delete d.path,delete d.samples,g.getElevationForLocations(d,function(a,b){e&&"function"==typeof e&&e(a,b)})},i.prototype.cleanRoute=i.prototype.removePolylines,i.prototype.drawRoute=function(a){var b=this;this.getRoutes({origin:a.origin,destination:a.destination,travelMode:a.travelMode,waypoints:a.waypoints,unitSystem:a.unitSystem,error:a.error,callback:function(c){c.length>0&&(b.drawPolyline({path:c[c.length-1].overview_path,strokeColor:a.strokeColor,strokeOpacity:a.strokeOpacity,strokeWeight:a.strokeWeight}),a.callback&&a.callback(c[c.length-1]))}})},i.prototype.travelRoute=function(a){if(a.origin&&a.destination)this.getRoutes({origin:a.origin,destination:a.destination,travelMode:a.travelMode,waypoints:a.waypoints,error:a.error,callback:function(b){if(b.length>0&&a.start&&a.start(b[b.length-1]),b.length>0&&a.step){var c=b[b.length-1];if(c.legs.length>0)for(var d,e=c.legs[0].steps,f=0;d=e[f];f++)d.step_number=f,a.step(d,c.legs[0].steps.length-1)
}b.length>0&&a.end&&a.end(b[b.length-1])}});else if(a.route&&a.route.legs.length>0)for(var b,c=a.route.legs[0].steps,d=0;b=c[d];d++)b.step_number=d,a.step(b)},i.prototype.drawSteppedRoute=function(a){var b=this;if(a.origin&&a.destination)this.getRoutes({origin:a.origin,destination:a.destination,travelMode:a.travelMode,waypoints:a.waypoints,error:a.error,callback:function(c){if(c.length>0&&a.start&&a.start(c[c.length-1]),c.length>0&&a.step){var d=c[c.length-1];if(d.legs.length>0)for(var e,f=d.legs[0].steps,g=0;e=f[g];g++)e.step_number=g,b.drawPolyline({path:e.path,strokeColor:a.strokeColor,strokeOpacity:a.strokeOpacity,strokeWeight:a.strokeWeight}),a.step(e,d.legs[0].steps.length-1)}c.length>0&&a.end&&a.end(c[c.length-1])}});else if(a.route&&a.route.legs.length>0)for(var c,d=a.route.legs[0].steps,e=0;c=d[e];e++)c.step_number=e,b.drawPolyline({path:c.path,strokeColor:a.strokeColor,strokeOpacity:a.strokeOpacity,strokeWeight:a.strokeWeight}),a.step(c)},i.Route=function(a){this.origin=a.origin,this.destination=a.destination,this.waypoints=a.waypoints,this.map=a.map,this.route=a.route,this.step_count=0,this.steps=this.route.legs[0].steps,this.steps_length=this.steps.length,this.polyline=this.map.drawPolyline({path:new google.maps.MVCArray,strokeColor:a.strokeColor,strokeOpacity:a.strokeOpacity,strokeWeight:a.strokeWeight}).getPath()},i.Route.prototype.getRoute=function(a){var b=this;this.map.getRoutes({origin:this.origin,destination:this.destination,travelMode:a.travelMode,waypoints:this.waypoints||[],error:a.error,callback:function(){b.route=e[0],a.callback&&a.callback.call(b)}})},i.Route.prototype.back=function(){if(this.step_count>0){this.step_count--;var a=this.route.legs[0].steps[this.step_count].path;for(var b in a)a.hasOwnProperty(b)&&this.polyline.pop()}},i.Route.prototype.forward=function(){if(this.step_count<this.steps_length){var a=this.route.legs[0].steps[this.step_count].path;for(var b in a)a.hasOwnProperty(b)&&this.polyline.push(a[b]);this.step_count++}},i.prototype.checkGeofence=function(a,b,c){return c.containsLatLng(new google.maps.LatLng(a,b))},i.prototype.checkMarkerGeofence=function(a,b){if(a.fences)for(var c,d=0;c=a.fences[d];d++){var e=a.getPosition();this.checkGeofence(e.lat(),e.lng(),c)||b(a,c)}},i.prototype.toImage=function(a){var a=a||{},b={};if(b.size=a.size||[this.el.clientWidth,this.el.clientHeight],b.lat=this.getCenter().lat(),b.lng=this.getCenter().lng(),this.markers.length>0){b.markers=[];for(var c=0;c<this.markers.length;c++)b.markers.push({lat:this.markers[c].getPosition().lat(),lng:this.markers[c].getPosition().lng()})}if(this.polylines.length>0){var d=this.polylines[0];b.polyline={},b.polyline.path=google.maps.geometry.encoding.encodePath(d.getPath()),b.polyline.strokeColor=d.strokeColor,b.polyline.strokeOpacity=d.strokeOpacity,b.polyline.strokeWeight=d.strokeWeight}return i.staticMapURL(b)},i.staticMapURL=function(a){function b(a,b){if("#"===a[0]&&(a=a.replace("#","0x"),b)){if(b=parseFloat(b),b=Math.min(1,Math.max(b,0)),0===b)return"0x00000000";b=(255*b).toString(16),1===b.length&&(b+=b),a=a.slice(0,8)+b}return a}var c,d=[],e="http://maps.googleapis.com/maps/api/staticmap";a.url&&(e=a.url,delete a.url),e+="?";var f=a.markers;delete a.markers,!f&&a.marker&&(f=[a.marker],delete a.marker);var g=a.styles;delete a.styles;var h=a.polyline;if(delete a.polyline,a.center)d.push("center="+a.center),delete a.center;else if(a.address)d.push("center="+a.address),delete a.address;else if(a.lat)d.push(["center=",a.lat,",",a.lng].join("")),delete a.lat,delete a.lng;else if(a.visible){var i=encodeURI(a.visible.join("|"));d.push("visible="+i)}var j=a.size;j?(j.join&&(j=j.join("x")),delete a.size):j="630x300",d.push("size="+j),a.zoom||a.zoom===!1||(a.zoom=15);var k=a.hasOwnProperty("sensor")?!!a.sensor:!0;delete a.sensor,d.push("sensor="+k);for(var l in a)a.hasOwnProperty(l)&&d.push(l+"="+a[l]);if(f)for(var m,n,o=0;c=f[o];o++){m=[],c.size&&"normal"!==c.size?(m.push("size:"+c.size),delete c.size):c.icon&&(m.push("icon:"+encodeURI(c.icon)),delete c.icon),c.color&&(m.push("color:"+c.color.replace("#","0x")),delete c.color),c.label&&(m.push("label:"+c.label[0].toUpperCase()),delete c.label),n=c.address?c.address:c.lat+","+c.lng,delete c.address,delete c.lat,delete c.lng;for(var l in c)c.hasOwnProperty(l)&&m.push(l+":"+c[l]);m.length||0===o?(m.push(n),m=m.join("|"),d.push("markers="+encodeURI(m))):(m=d.pop()+encodeURI("|"+n),d.push(m))}if(g)for(var o=0;o<g.length;o++){var p=[];g[o].featureType&&"all"!=g[o].featureType&&p.push("feature:"+g[o].featureType),g[o].elementType&&"all"!=g[o].elementType&&p.push("element:"+g[o].elementType);for(var q=0;q<g[o].stylers.length;q++)for(var r in g[o].stylers[q]){var s=g[o].stylers[q][r];("hue"==r||"color"==r)&&(s="0x"+s.substring(1)),p.push(r+":"+s)}var t=p.join("|");""!=t&&d.push("style="+t)}if(h){if(c=h,h=[],c.strokeWeight&&h.push("weight:"+parseInt(c.strokeWeight,10)),c.strokeColor){var u=b(c.strokeColor,c.strokeOpacity);h.push("color:"+u)}if(c.fillColor){var v=b(c.fillColor,c.fillOpacity);h.push("fillcolor:"+v)}var w=c.path;if(w.join)for(var x,q=0;x=w[q];q++)h.push(x.join(","));else h.push("enc:"+w);h=h.join("|"),d.push("path="+encodeURI(h))}var y=window.devicePixelRatio||1;return d.push("scale="+y),d=d.join("&"),e+d},i.prototype.addMapType=function(a,b){if(!b.hasOwnProperty("getTileUrl")||"function"!=typeof b.getTileUrl)throw"'getTileUrl' function required.";b.tileSize=b.tileSize||new google.maps.Size(256,256);var c=new google.maps.ImageMapType(b);this.map.mapTypes.set(a,c)},i.prototype.addOverlayMapType=function(a){if(!a.hasOwnProperty("getTile")||"function"!=typeof a.getTile)throw"'getTile' function required.";var b=a.index;delete a.index,this.map.overlayMapTypes.insertAt(b,a)},i.prototype.removeOverlayMapType=function(a){this.map.overlayMapTypes.removeAt(a)},i.prototype.addStyle=function(a){var b=new google.maps.StyledMapType(a.styles,{name:a.styledMapName});this.map.mapTypes.set(a.mapTypeId,b)},i.prototype.setStyle=function(a){this.map.setMapTypeId(a)},i.prototype.createPanorama=function(a){return a.hasOwnProperty("lat")&&a.hasOwnProperty("lng")||(a.lat=this.getCenter().lat(),a.lng=this.getCenter().lng()),this.panorama=i.createPanorama(a),this.map.setStreetView(this.panorama),this.panorama},i.createPanorama=function(b){var c=g(b.el,b.context);b.position=new google.maps.LatLng(b.lat,b.lng),delete b.el,delete b.context,delete b.lat,delete b.lng;for(var d=["closeclick","links_changed","pano_changed","position_changed","pov_changed","resize","visible_changed"],e=a({visible:!0},b),f=0;f<d.length;f++)delete e[d[f]];for(var h=new google.maps.StreetViewPanorama(c,e),f=0;f<d.length;f++)!function(a,c){b[c]&&google.maps.event.addListener(a,c,function(){b[c].apply(this)})}(h,d[f]);return h},i.prototype.on=function(a,b){return i.on(a,this,b)},i.prototype.off=function(a){i.off(a,this)},i.custom_events=["marker_added","marker_removed","polyline_added","polyline_removed","polygon_added","polygon_removed","geolocated","geolocation_failed"],i.on=function(a,b,c){if(-1==i.custom_events.indexOf(a))return google.maps.event.addListener(b,a,c);var d={handler:c,eventName:a};return b.registered_events[a]=b.registered_events[a]||[],b.registered_events[a].push(d),d},i.off=function(a,b){-1==i.custom_events.indexOf(a)?google.maps.event.clearListeners(b,a):b.registered_events[a]=[]},i.fire=function(a,b,c){if(-1==i.custom_events.indexOf(a))google.maps.event.trigger(b,a,Array.prototype.slice.apply(arguments).slice(2));else if(a in c.registered_events)for(var d=c.registered_events[a],e=0;e<d.length;e++)!function(a,b,c){a.apply(b,[c])}(d[e].handler,c,b)},i.geolocate=function(a){var b=a.always||a.complete;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(c){a.success(c),b&&b()},function(c){a.error(c),b&&b()},a.options):(a.not_supported(),b&&b())},i.geocode=function(a){this.geocoder=new google.maps.Geocoder;var b=a.callback;a.hasOwnProperty("lat")&&a.hasOwnProperty("lng")&&(a.latLng=new google.maps.LatLng(a.lat,a.lng)),delete a.lat,delete a.lng,delete a.callback,this.geocoder.geocode(a,function(a,c){b(a,c)})},google.maps.Polygon.prototype.getBounds||(google.maps.Polygon.prototype.getBounds=function(){for(var a,b=new google.maps.LatLngBounds,c=this.getPaths(),d=0;d<c.getLength();d++){a=c.getAt(d);for(var e=0;e<a.getLength();e++)b.extend(a.getAt(e))}return b}),google.maps.Polygon.prototype.containsLatLng||(google.maps.Polygon.prototype.containsLatLng=function(a){var b=this.getBounds();if(null!==b&&!b.contains(a))return!1;for(var c=!1,d=this.getPaths().getLength(),e=0;d>e;e++)for(var f=this.getPaths().getAt(e),g=f.getLength(),h=g-1,i=0;g>i;i++){var j=f.getAt(i),k=f.getAt(h);(j.lng()<a.lng()&&k.lng()>=a.lng()||k.lng()<a.lng()&&j.lng()>=a.lng())&&j.lat()+(a.lng()-j.lng())/(k.lng()-j.lng())*(k.lat()-j.lat())<a.lat()&&(c=!c),h=i}return c}),google.maps.LatLngBounds.prototype.containsLatLng=function(a){return this.contains(a)},google.maps.Marker.prototype.setFences=function(a){this.fences=a},google.maps.Marker.prototype.addFence=function(a){this.fences.push(a)},google.maps.Marker.prototype.getId=function(){return this.__gm_id},Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:0!=d&&1/0!=d&&d!=-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1}),i}),function(a,d){"object"==typeof exports?module.exports=d(b("umodel"),b("u")):"function"==typeof c&&c.amd?c("microbox",["umodel","u"],d):a.microbox=d(a.umodel,a.u)}(this,function(a,b){var c,d,e,f;return f=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(e="",q=a.images,k=0,n=q.length;n>k;k++)j=q[k],e+='<img src="'+j+'" alt="" />';for(d="",r=a.captions,h=l=0,o=r.length;o>l;h=++l)c=r[h],c&&(d+='<div class="caption" microbox-caption="'+h+'">\n	<span class="microbox-button" microbox-trigger-caption>i</span>\n	'+c+"\n</div>");if(a.images.length>1){for(g="",s=a.images,h=m=0,p=s.length;p>m;h=++m)f=s[h],g+='<li microbox-trigger-set="'+b+'" microbox-trigger-index="'+h+'">'+(h+1)+"</li>";i='<ul class="microbox-pager">\n	<li class="microbox-counts">'+(a.active+1)+"/"+a.images.length+'</li>\n	<li microbox-trigger-prev microbox-trigger-set="'+b+'">&#9656;</li>\n	'+g+'\n	<li microbox-trigger-next microbox-trigger-set="'+b+'">&#9656;</li>\n</ul>'}else i="";return'<span class="microbox-button microbox-close" microbox-close>&times;</span>\n<div class="inner">\n	'+e+"\n</div>\n"+d+"\n"+i},c=function(a,b,c){return b>a?a=b:a>c&&(a=c),a},d={27:"esc",37:"left",39:"right",65:"a",68:"d"},e=function(){var e,g,h,i,j,k,l,m,n,o;return g=-1,k=new a({visible:null,sets:{}}),h=function(){for(;!(++g in k.get("sets"));)return g},o=function(a,d,e){var f,g,h,i,j,l;return null==d&&(d=0),null==a?(console.error("microbox.toggle expects a set ID, given '"+a+"'"),!1):(j=k.get("sets/"+a),i=j.images.length-1,h=j.element,null==j?(console.error("microbox.toggle passed an invalid set id '"+a+"'"),!1):(d=c(+d,0,i),l=e===!0?"add":e===!1?"remove":"toggle",b.classList[l](h,"visible"),b.classList.contains(h,"visible")?(g=j.components,b.each(g.images,function(a){return b.classList.remove(a,"visible")}),b.classList.add(g.images[d],"visible"),g.counts.innerHTML=""+(d+1)+"/"+j.images.length,b.each(g.pagerItems,function(a){return b.classList.remove(a,"active")}),b.classList.add(g.pagerItems[d],"active"),l=0===d?"add":"remove",b.classList[l](g.prev,"disabled"),l=d===i?"add":"remove",b.classList[l](g.next,"disabled"),b.each(g.captions,function(a){return b.classList.add(a,"hide"),b.classList.remove(a,"active"),a.style.top=""}),g.pager.style.bottom="",f=g.captions[d],f&&b.classList.remove(f,"hide"),j.active=d,k.set("visible",j)):k.set("visible",null)))},e=function(a,b){var c,d;return d=k.get("sets/"+a),c=d.triggers.indexOf(b),b.addEventListener("click",function(b){return b.preventDefault(),o(a,c)})},j=function(){var a;return a=document.querySelectorAll('a[href][rel^="lightbox"]'),b.each(a,function(a){var b,c,d,f,g,i;return b=a.getAttribute("href"),f=a.getAttribute("rel"),i=a.getAttribute("title")||"",d=f.split("["),c=d[1]?d[1].slice(0,-1):h(),g=k.get("sets/"+c),g?g.triggers.indexOf(a)<0&&(g.captions.push(i),g.images.push(b),g.triggers.push(a)):k.set("sets/"+c,{captions:[i],images:[b],triggers:[a],active:0,id:c}),e(c,a)}),b.each(k.get("sets"),function(a,c){var d,e;return e=f(a,c),d=document.createElement("div"),d.className="microbox",d.innerHTML=e,document.body.appendChild(d),a=k.get("sets/"+c),a.element=d,a.components={captions:[],counts:d.querySelector(".microbox-counts"),images:d.querySelectorAll("img"),pager:d.querySelector(".microbox-pager"),pagerItems:d.querySelectorAll("[microbox-trigger-index]"),next:d.querySelector("[microbox-trigger-next]"),prev:d.querySelector("[microbox-trigger-prev]")},b.each(d.querySelectorAll("[microbox-caption]"),function(b){return c=+b.getAttribute("microbox-caption"),a.components.captions[c]=b})})},document.addEventListener("click",function(a){var c,d,e,f,g,h,j,k,n;return k=a.target,b.classList.contains(k,"inner")||k.hasAttribute("microbox-close")?i():k.hasAttribute("microbox-trigger-index")&&k.hasAttribute("microbox-trigger-set")?(j=k.getAttribute("microbox-trigger-set"),e=k.getAttribute("microbox-trigger-index"),o(j,e,!0)):k.hasAttribute("microbox-trigger-next")||k.hasAttribute("microbox-trigger-prev")?k.hasAttribute("microbox-trigger-next")?l():m():k.hasAttribute("microbox-trigger-caption")?(c=k.parentNode,d=c.offsetHeight,h=window.innerHeight,n=c.style.top,g=c.parentNode.querySelector(".microbox-pager"),n&&parseInt(n,10)!==h?(b.classList.remove(c,"active"),c.style.top="",g.style.bottom=""):(f=h-d,c.style.top=""+f+"px",b.classList.add(c,"active"),g.style.bottom=""+(d+10)+"px")):void 0}),window.addEventListener("keydown",function(a){var b,c;if(b=d[a.keyCode],c=k.get("visible"),b&&c)switch(b){case"esc":return i();case"left":case"a":return m();case"right":case"d":return l()}}),i=function(){var a,b,c;return c=k.get("visible"),c?(a=c.id,b=k.get("sets/"+a+"/active"),o(a,null,!1)):console.error("microbox.hide() can only be called when a set is visible")},n=function(a){var c;return k.get("sets/"+a)?o(a,null,!0):(c=b.keys(k.get("sets")),console.error("Set with ID '"+a+"' does not exist. Available sets: ",c))},l=function(){var a,b,c;return c=k.get("visible"),c?(a=c.id,b=k.get("sets/"+a+"/active"),o(a,++b,!0)):console.error("microbox.next() can only be called when a set is visible")},m=function(){var a,b,c;return c=k.get("visible"),c?(a=c.id,b=k.get("sets/"+a+"/active"),o(a,--b,!0)):console.error("microbox.prev() can only be called when a set is visible")},j(),{init:j,next:l,prev:m,hide:i,show:n}}()}),function(){function a(a){return(a||"").split(" ")}function b(a,b,c){return e(a,b,c,!1)}function c(a,b,c){return e(a,b,c,!0)}function d(a){return function(c,d){return b(c,d,a)}}function e(a,b,c,d){b&&!f(b)&&(c=b,b=void 0),b=b||new Date,c=c||l,c.formats=c.formats||{};var k=0;return d&&(k=6e4*(b.getTimezoneOffset()||0),b=new Date(b.getTime()+k)),a.replace(/%([-_0]?.)/g,function(a,f){var l,m;if(2==f.length){if(l=f[0],"-"==l)m="";else if("_"==l)m=" ";else{if("0"!=l)return a;m="0"}f=f[1]}switch(f){case"A":return c.days[b.getDay()];case"a":return c.shortDays[b.getDay()];case"B":return c.months[b.getMonth()];case"b":return c.shortMonths[b.getMonth()];case"C":return g(Math.floor(b.getFullYear()/100),m);case"D":return e(c.formats.D||"%m/%d/%y",b,c);case"d":return g(b.getDate(),m);case"e":return b.getDate();case"F":return e(c.formats.F||"%Y-%m-%d",b,c);case"H":return g(b.getHours(),m);case"h":return c.shortMonths[b.getMonth()];case"I":return g(h(b),m);case"j":var n=new Date(b.getFullYear(),0,1),o=Math.ceil((b.getTime()-n.getTime())/864e5);return g(o,3);case"k":return g(b.getHours(),null==m?" ":m);case"L":return g(Math.floor(b.getTime()%1e3),3);case"l":return g(h(b),null==m?" ":m);case"M":return g(b.getMinutes(),m);case"m":return g(b.getMonth()+1,m);case"n":return"\n";case"o":return String(b.getDate())+i(b.getDate());case"P":return b.getHours()<12?c.am:c.pm;case"p":return b.getHours()<12?c.AM:c.PM;case"R":return e(c.formats.R||"%H:%M",b,c);case"r":return e(c.formats.r||"%I:%M:%S %p",b,c);case"S":return g(b.getSeconds(),m);case"s":return Math.floor((b.getTime()-k)/1e3);case"T":return e(c.formats.T||"%H:%M:%S",b,c);case"t":return"	";case"U":return g(j(b,"sunday"),m);case"u":var o=b.getDay();return 0==o?7:o;case"v":return e(c.formats.v||"%e-%b-%Y",b,c);case"W":return g(j(b,"monday"),m);case"w":return b.getDay();case"Y":return b.getFullYear();case"y":var n=String(b.getFullYear());return n.slice(n.length-2);case"Z":if(d)return"GMT";var p=b.toString().match(/\((\w+)\)/);return p&&p[1]||"";case"z":if(d)return"+0000";var q=b.getTimezoneOffset();return(0>q?"+":"-")+g(Math.abs(q/60))+g(q%60);default:return f}})}function f(a){var b=0,c=m.length;for(b=0;c>b;++b)if("function"!=typeof a[m[b]])return!1;return!0}function g(a,b,c){"number"==typeof b&&(c=b,b="0"),null==b&&(b="0"),c=c||2;var d=String(a);if(b)for(;d.length<c;)d=b+d;return d}function h(a){var b=a.getHours();return 0==b?b=12:b>12&&(b-=12),b}function i(a){var b=a%10,c=a%100;if(c>=11&&13>=c||0===b||b>=4)return"th";switch(b){case 1:return"st";case 2:return"nd";case 3:return"rd"}}function j(a,b){b=b||"sunday";var c=a.getDay();"monday"==b&&(0==c?c=6:c--);var d=new Date(a.getFullYear(),0,1),e=(a-d)/864e5,f=(e+7-c)/7;return Math.floor(f)}var k;k="undefined"!=typeof module?module.exports=b:function(){return this||(1,eval)("this")}(),k.strftime=b,k.strftimeUTC=b.strftimeUTC=c,k.localizedStrftime=b.localizedStrftime=d;var l={days:a("Sunday Monday Tuesday Wednesday Thursday Friday Saturday"),shortDays:a("Sun Mon Tue Wed Thu Fri Sat"),months:a("January February March April May June July August September October November December"),shortMonths:a("Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec"),AM:"AM",PM:"PM",am:"am",pm:"pm"},m=["getTime","getTimezoneOffset","getDay","getDate","getMonth","getFullYear","getYear","getHours","getMinutes","getSeconds"]}(),c("strftime",function(a){return function(){var b;return b||a.strftime}}(this)),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof c&&c.amd?c("uxhr",b):a.uxhr=b()}(this,function(){return function(a,b,c){b=b||"",c=c||{};var d=c.complete||function(){},e=c.success||function(){},f=c.error||function(){},g=c.headers||{},h=c.method||"GET",i=c.sync||!1,j=function(){return 0===a.indexOf("http")&&"undefined"!=typeof XDomainRequest?new XDomainRequest:new XMLHttpRequest}();if(!j)throw new Error("Browser doesn't support XHR");if("string"!=typeof b){var k=[];for(var l in b)k.push(l+"="+b[l]);b=k.join("&")}"ontimeout"in j&&(j.ontimeout=+c.timeout||0),j.onload=function(){d(j.responseText,j.status),e(j.responseText)},j.onerror=function(){d(j.responseText),f(j.responseText,j.status)},j.open(h,"GET"===h&&b?a+"?"+b:a,i);for(var m in g)j.setRequestHeader(m,g[m]);j.send("GET"!==h?b:null)}}),c("resume",["require","annie","bubblegraph","GMaps","microbox","strftime","umodel","util","uxhr","u"],function(a){var b,c,d,e,f,g,h,i,j,k;return e=a("annie"),b=a("bubblegraph"),c=a("GMaps"),f=a("microbox"),g=a("strftime"),i=a("umodel"),j=a("util"),k=a("uxhr"),h=a("u"),d=function(){function a(a){j.log("loaded!"),_.extend(this.options,a),this.attachEvents(),document.title=""+this.options.name+"'s Resume",this.render(),this.resize(),j.log("rendered!")}return a.prototype.options={name:"John Smith",contact:{},element:document.body,history:[],objective:"",skills:[],colors:["0B486B","A8DBA8","79BD9A","3B8686","CFF09E"],templateHeader:function(){var a,b,c,d,e,f;d={email:"Email",github:"GitHub",npm:"NPM",www:"Web"},f=function(a,b){switch(a){case"email":return"mailto:"+b;case"github":return"https://github.com/"+b;case"npm":return"https://npmjs.org/~"+b;case"www":return 0!==b.indexOf("http")?"http://"+b:b}},a="",e=this.contact;for(b in e)c=e[b],a+='<li><a class="'+b+'" href="'+f(b,c)+'">'+d[b]+"</a></li>";return"<header>\n	<h1>"+this.name+"'s Resume</h1>\n	<ul>"+a+"</ul>\n</header>"},templateCover:function(){var a;return a='<span class="tag">'+this.skills.join('</span><span class="tag">')+"</span>",'<div id="cover">\n	<h3 id="objective">'+marked(this.objective)+'</h3>\n	<div id="skills">'+a+"</div>\n</div>"},templateHistory:function(){return'<div id="details" class="hide">\n	'+this.content+"\n</div>"},templateHistoryItem:function(){var a,b,c,d,e,f,h,i,k,l,m,n,o,p,q,r,s,t,u;for(null===this.when[1]&&(b=new Date,this.when[1]=""+b.getFullYear()+"-"+b.getMonth()),d=g("%B %Y",j.strtotime(this.when[0])),o=g("%B %Y",j.strtotime(this.when[1])),i=this.location?(this.location.city?""+this.location.city+",":"")+" "+(this.location.state||""):"",m="- "+this.responsibilities.join("\n- "),n='<span class="tag">'+this.skills.join('</span><span class="tag">')+"</span>",a=[{field:"company",value:"**"+this.company+"**"},{field:"title",value:this.title},{field:"location",value:i},{field:"when",value:""+d+" - "+o},{field:"description",value:this.description},{field:"responsibilities",value:m},{field:"skills",value:n}],c="",q=0,s=a.length;s>q;q++)h=a[q],null!=h.value&&(c+="<dt>"+h.field+"</dt><dd>"+marked(h.value)+"</dd>");if(this.images){for(f='<dt>Screenshots</dt><dd><ul class="images">',u=this.images,l=r=0,t=u.length;t>r;l=++r)e=u[l],p="data/images/"+e,f+='<li><a href="'+p+'" rel="lightbox['+this.company+']"><img src="'+p+'" alt="'+this.company+' screenshot" /></a></li>';f+="</ul></dd>"}else f="";return k=this.location?'<span class="map-placeholder">\n	Loading<br />\n	map...\n	<span class="spinner"></span>\n</span>':"",'<section class="detail hide">\n	'+k+"\n	<dl>\n		"+c+"\n		"+f+"\n	</dl>\n</section>"}},a.prototype.model=new i({graph:null}),a.prototype.attachEvents=function(){var a=this;return document.addEventListener("click",function(b){return a.clickBody(b)}),window.addEventListener("resize",function(){return a.resize}),window.addEventListener("deviceorientation",function(){return a.resize})},a.prototype.clickBody=function(a){var b,c,d,e,f,g;return b=a.target,d=this.isCircle(b),f=this.getDetails(b),e=this.isClickMeText(b),g=this.isLightbox(b),c=this.model.get("graph"),g?!1:d||f||e||!c?void 0:(c.deactivate(),h.classList.remove(document.querySelector("svg"),"small"))},a.prototype.isLightbox=function(a){for(;a!==document;){if(h.classList.contains(a,"microbox"))return!0;a=a.parentNode}},a.prototype.isCircle=function(a){return"circle"===a.tagName},a.prototype.isDetails=function(a){return"details"===a.id},a.prototype.isClickMeText=function(a){return"clickme"===a.id},a.prototype.getDetails=function(a){for(;a!==document;){if(this.isDetails(a))return a;a=a.parentNode}},a.prototype.render=function(){var a,b=this;return a=[{fn:"renderHistory",log:"rendered history!"},{fn:"clearSpinner"},{fn:"renderMaps",log:"rendered maps!"},{fn:"renderBubbles",log:"rendered bubbles!"},{fn:"initLightboxes",log:"initialized lightboxes"},{fn:"getRepoCount",log:"rendered repo counts!"}],_.each(a,function(a){return _.defer(_.bind(b[a.fn],b)),a.log?j.log(a.log):void 0})},a.prototype.clearSpinner=function(){var a;return a=document.querySelector("#loading"),h.classList.add(a,"fade-out")},a.prototype.initLightboxes=function(){return f.init()},a.prototype.renderHistory=function(){var a,b,c,d,e,f;for(a=b="",a+=this.options.templateHeader.call(this.options),a+=this.options.templateCover.call(this.options),f=this.options.history,d=0,e=f.length;e>d;d++)c=f[d],b+=this.options.templateHistoryItem.call(c);return a+=this.options.templateHistory.call({content:b}),this.options.element.innerHTML=a},a.prototype.renderBubbles=function(){var a;return a=new b({colors:this.options.colors,data:this.options.history,element:this.options.element}),this.model.set("graph",a)},a.prototype.renderMaps=function(){var a,b,d,e=this;return a=document.querySelector("#details"),h.classList.remove(a,"hide"),d=a.offsetWidth-20,h.classList.add(a,"hide"),b=a.querySelectorAll(".map-placeholder"),_.each(this.options.history,function(a,f){var g,i,j,k;return j=a.location,j?(g=""+(j.address||"")+" "+(j.city||"")+" "+(j.state||""),k=c.staticMapURL({address:g,markers:[{color:e.options.colors[f%e.options.colors.length],address:g}],size:[d,150],zoom:9}),i=document.createElement("img"),i.alt="",i.className="map",i.src=k,i.width=d,i.onload=function(){return h.classList.add(b[f],"fade-out"),setTimeout(function(){return b[f].parentNode.replaceChild(i,b[f]),_.defer(function(){return h.classList.add(i,"fade-in")})},200)}):void 0})},a.prototype.templateRepoCounts=function(a){var b,c,d,e,f;e=JSON.parse(a),f=[];for(d in e)b=e[d],"number"==typeof b&&f.push(function(){var a,e,f,g;for(f=document.querySelectorAll("."+d),g=[],a=0,e=f.length;e>a;a++)c=f[a],g.push(c.innerHTML+=" ("+b+")");return g}());return f},a.prototype.getRepoCount=function(){return k("http://www.contributor.io/api",this.options.contact,{success:this.templateRepoCounts})},a.prototype.resize=function(){var a,b,c,d,f,g,h,i,j;return f=.7,c=-60,i=-28,j=-27,a=Math.floor(this.options.element.offsetHeight/100),5>a&&(f=(a+1)/10,c=-60+20*(5-a)),b="transform",h="scale("+f+") translate3d("+i+"%, "+j+"%, 0) rotate("+c+"deg);",d="svg.small {\n	-"+e.vendor.toLowerCase()+"-"+b+": "+h+"\n	"+b+": "+h+"\n}",g=document.styleSheets[0],g.insertRule(d,g.cssRules.length)},a}()}),c("main",["require","resume","uxhr"],function(a){var b,c,d,e;return b=a("resume"),e=a("uxhr"),c=function(a){return new b(_.extend(a,{element:document.getElementById("resume")}))},d=function(a,b){return e(a,{},{complete:function(a){return b(JSON.parse(a))}})},d("data/data.json",c)}),b(["config","main"]),c("app.js",function(){})}();